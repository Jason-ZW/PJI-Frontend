<view class="cu-custom" style="height:{{CustomBar}}px;">
    <view class="cu-bar fixed bg-gradual-green" style="height:{{CustomBar}}px;padding-top:{{StatusBar}}px;">
        <navigator class='action border-custom' open-type="navigateBack" delta="1" hover-class="none" style='width:{{Custom.width}}px;height:{{Custom.height}}px;margin-left:calc(750rpx - {{Custom.right}}px)'>
            <text class='icon-back'></text>
            <text class='icon-homefill'></text>
        </navigator>
        <view class='content' style='top:{{StatusBar}}px;'>复诊随访</view>
    </view>
</view>
<view class="cu-bar bg-white fixed" style="top:{{CustomBar}}px;">
    <view class="flex">
        <view class='avatar-group'>
            <view class="cu-avatar-group">
                <view class='cu-tag radius' style="margin-right: 40rpx;">填</view>
                <view class="cu-avatar round" style="background-image:url({{addAvatar}});"></view>
            </view>
        </view>
    </view>
    <view class="flex">
        <view class='avatar-group'>
            <view class="cu-avatar-group">
                <view wx:if="{{updateAvatarArr.length > 0}}">
                    <view class='cu-tag radius' style="margin-right: 40rpx;">修</view>
                    <view class="cu-avatar round" wx:for="{{updateAvatarArr}}" wx:key style="background-image:url({{item}});"></view>
                </view>
                <view wx:else>
                    <view class='cu-tag radius' style="margin-right: 10rpx;">修</view>
                    <view class='cu-tag radius'>暂无</view>
                </view>
            </view>
        </view>
    </view>
    <view class="flex">
        <view class='avatar-group'>
            <view class="cu-avatar-group">
                <view wx:if="{{approveAvatar.length > 0}}">
                    <view class='cu-tag radius' style="margin-right: 40rpx;">审</view>
                    <view class="cu-avatar round" style="background-image:url({{approveAvatar}});"></view>
                </view>
                <view wx:else>
                    <view class='cu-tag radius' style="margin-right: 10rpx;">审</view>
                    <view class='cu-tag radius'>暂无</view>
                </view>
            </view>
        </view>
    </view>
</view>
<scroll-view scroll-y class="indexes" scroll-into-view="indexes-{{listCurID}}" style='padding-top: 100rpx;height:100%' scroll-with-animation="true" enable-back-to-top="true">
    <view class="VerticalBox" style="height: 100%;">

        <scroll-view class="VerticalMain" scroll-y style="height:100%">
            <view class="padding-left-special">
                <view class="cu-list menu menu-avatar">
                    <view class="cu-item-special">
                        <!-- 门诊时间 -->
                        <view class="cu-form-group {{follow_date_state==2?'clock':''}}">
                            <view class='title'>门诊时间</view>
                            <picker mode="date" value="{{follow_date}}" start="2015-01-01" end="2030-12-31" bindchange="onDateChange" disabled="{{follow_date_state==2}}" data-type="follow_date">
                                <view class="picker">
                                    {{follow_date}}
                                </view>
                            </picker>
                        </view>
                        <!-- 本次复诊目的 -->
                        <view class="cu-form-group">
                            <view class='title'>本次复诊目的</view>
                            <picker bindchange="onPickerChange" value="{{purpose}}" range="{{purpose_picker}}" disabled="{{purpose_state==2}}" data-type="purpose">
                                <view class="picker">
                                    {{purpose_picker[purpose]}}
                                </view>
                            </picker>
                        </view>
                        <!-- 患者主诉 -->
                        <view class="cu-form-group {{patient_desc_state==0?'disabled':patient_desc_state==2?'clock':''}}">
                            <view style='display:flex;flex-direction: column; '>
                                <view class='title' style='text-align:left'>患者主诉</view>
                                <input style=' width: 350rpx;text-algin:left;' class='radius' style='text-align:left;' bindinput="onInput" value='{{patient_desc}}' placeholder="请输入文字" disabled='{{patient_desc_state!=1}}' data-type="patient_desc"></input>
                            </view>
                            <i class="fa fa-{{patient_desc_state_value}} fa-2x" data-type="patient_desc_state" data-style="input" data-state="{{patient_desc_state}}" style="pointer-events:{{assay_check?'none':''}}" bindtap="on2StateChange"></i>
                        </view>
                        <!-- 外观状态 -->
                        <view class="cu-form-group {{exterior_state==0?'disabled':exterior_state==2?'clock':''}}">
                            <view style='display:flex;flex-direction: column; '>
                                <view class='title' style='text-align:left'>外观状态</view>
                                <input placeholder="请输入文字" class='radius' style='width: 350rpx;text-align:left;' bindinput="onInput" disabled='{{exterior_state!=1}}' value='{{exterior}}' data-type="exterior"></input>
                            </view>
                            <view>
                                <button class='cu-btn round sm' disabled='{{exterior_state!=1}}' bindtap="showModal" data-target="threeImgModal" data-imgtype="exterior_pic">上传图片</button>
                                <i class="fa fa-{{exterior_state_value}} fa-2x" data-type="exterior_state" data-style="input_pic" data-state="{{exterior_state}}" style="pointer-events:{{assay_check?'none':''}}" bindtap="on2StateChange"></i>
                            </view>
                        </view>
                        <!-- 新增化验结果 -->
                        <view class="cu-form-group {{assay_result_state==0?'disabled':assay_result_state==2?'clock':''}}">
                            <view style='display:flex;flex-direction: column; '>
                                <view class='title' style='text-align:left'>新增化验结果</view>
                                <input placeholder="请输入文字" class='radius' style='width: 350rpx;text-align:left;' bindinput="onInput" disabled='{{assay_result_state!=1}}' value='{{assay_result}}' data-type="assay_result"></input>
                            </view>
                            <view>
                                <button class='cu-btn round sm' style='margin-left: 15rpx;' disabled='{{assay_result_state!=1}}' value='{{assay_result}}' bindtap="showModal" data-target="threeImgModal" data-imgtype="assay_result_pic">上传图片</button>
                                <i class="fa fa-{{assay_result_state_value}} fa-2x" data-type="assay_result_state" data-style="input_pic" data-state="{{assay_result_state}}" style="pointer-events:{{assay_check?'none':''}}" bindtap="on3StateChange"></i>
                            </view>
                        </view>
                        <!-- 新增检查结果 -->
                        <view class="cu-form-group {{check_result_state==0?'disabled':check_result_state==2?'clock':''}}">
                            <view style='display:flex;flex-direction: column; '>
                                <view class='title' style='text-align:left'>新增检查结果</view>
                                <input placeholder="请输入文字" class='radius' style='width: 350rpx;text-align:left;' bindinput="onInput" disabled='{{check_result_state!=1}}' value='{{check_result}}' data-type="check_result"></input>
                            </view>
                            <view>
                                <button class='cu-btn round sm' style='margin-left: 15rpx;' disabled='{{check_result_state!=1}}' bindtap="showModal" data-target="threeImgModal" data-imgtype="check_result_pic">上传图片</button>
                                <i class="fa fa-{{check_result_state_value}} fa-2x" data-type="check_result_state" data-style="input_pic" data-state="{{check_result_state}}" style="pointer-events:{{assay_check?'none':''}}" bindtap="on3StateChange"></i>
                            </view>
                        </view>
                        <!-- 目前诊断 -->
                        <view class="cu-form-group {{diagnose_state==0?'disabled':diagnose_state==2?'clock':''}}">
                            <view class='title'>目前诊断</view>
                            <picker bindchange="onPickerChange" value="{{diagnose}}" range="{{diagnose_picker}}" disabled='{{diagnose_state != 1}}' data-type="diagnose">
                                <view class="picker">
                                    {{diagnose_picker[diagnose]}}
                                </view>
                            </picker>
                            <i class="fa fa-{{diagnose_state_value}} fa-2x" style="pointer-events:{{puncture_summary?'none':''}}" data-type="diagnose_state" data-style="picker" data-state="{{diagnose_state}}" bindtap="on2StateChange"></i>
                        </view>
                        <!-- 下一步计划 -->
                        <view class="cu-form-group">
                            <view class='title'>下一步计划</view>
                            <picker bindchange="onPickerChange" value="{{plan}}" range="{{plan_picker}}" disabled='{{plan_state==2}}' data-type="plan">
                                <view class="picker">
                                    {{plan_picker[plan]}}
                                </view>
                            </picker>
                        </view>
                        <!-- 备注 -->
                        <view class="cu-form-group">
                            <view style='display:flex;flex-direction: column; '>
                                <view class='title' style='text-align:left'>备注</view>
                                <input placeholder="请输入文字" class='radius' style='width: 350rpx;text-align:left;' bindinput="onInput" value='{{remark}}' disabled="{{remark_state==2}}" data-type="remark"></input>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
            <!-- 底部按钮 -->
            <view class="btn-block bg-white shadow" hidden='{{isLook}}'>
                <view class="flex margin-special">
                    <button wx:if="{{isEdit || isCreate}}" class='cu-btn line-green shadow' style="margin-right: 15rpx;" form-type="submit" bindtap='submit' disabled='{{caseInfo.followup_submit_button == 0}}'>
                        提交录入
                    </button>
                    <button wx:else class='cu-btn line-green shadow' style="margin-right: 15rpx;" form-type="submit" bindtap='onSetCaseWrite'>
                        编辑修改
                    </button>
                    <button class='cu-btn bg-green shadow' style="margin-left: 15rpx;" form-type="submit" bindtap='verify' disabled='{{isCreate || caseInfo.approve_button == 2}}'>
                        {{caseInfo.followup_state != 2 ?"确认审核":"解除锁定"}}
                    </button>
                </view>
            </view>
        </scroll-view>
    </view>
</scroll-view>

<!-- 模态对话框 -->
<!-- 上传图片 3张 -->
<view class="cu-modal drawer-modal justify-end {{modalName=='threeImgModal'?'show ':''}}" bindtap='hideModal'>
    <view class="cu-dialog basis-lg" catchtap style="top:{{CustomBar}}px;">
        <view class="cu-bar bg-white solid-bottom">
            <view class='action ' style="font-size: 24rpx;">
                <text class='icon-title text-blue'></text>上传图片
            </view>
        </view>
        <view class="cu-form-group margin-top centerPlace">
            <view class="grid col-3 grid-square flex-sub centerPlace">
                <view class="imageShow solids padding-xs" wx:if="{{pic1 !== ''}}">
                    <image src="{{pic1}}" mode='aspectFit' bindtap="showImageModal" data-img="{{pic1}}" />
                    <button class='cu-btn bg-red shadow sm ' bindtap="onRemovePic" data-le="11">
                        删除
                    </button>
                </view>
                <view class="padding-xs solids imageAdd" wx:if="{{pic1 == ''}}">
                    <text class='icon-cameraadd ' bindtap="onChooseImage" data-le="11"></text>
                </view>
                <view class="imageShow solids padding-xs" wx:if="{{pic2 !== ''}}">
                    <image src="{{pic2}}" mode='aspectFit ' bindtap="showImageModal" data-img="{{pic2}}" />
                    <button class='cu-btn bg-red shadow sm ' bindtap="onRemovePic" data-le="12">
                        删除
                    </button>
                </view>
                <view class="padding-xs solids imageAdd" wx:if="{{pic2 == ''}}">
                    <text class='icon-cameraadd ' bindtap="onChooseImage" data-le="12"></text>
                </view>
                <view class="imageShow solids padding-xs" wx:if="{{pic3 !== ''}}">
                    <image src="{{pic3}}" mode='aspectFit' bindtap="showImageModal" data-img="{{pic3}}" />
                    <button class='cu-btn bg-red shadow sm' bindtap="onRemovePic" data-le="13">
                        删除
                    </button>
                </view>
                <view class="padding-xs solids imageAdd" wx:if="{{pic3 == ''}}">
                    <text class='icon-cameraadd' bindtap="onChooseImage" data-le="13"></text>
                </view>
            </view>
        </view>
    </view>
</view>
<view class="cu-modal {{showImageModal?'show':''}}">
    <view class="cu-dialog">
        <view class="">
            <view style="float:left;width:100%;">
                <image src="{{modalImage}}" mode='aspectFit' style="height: 800rpx;" />
            </view>
            <view style="float:left;width:100%;margin: 30rpx 0rpx;">
                <button class='cu-btn bg-red shadow' bindtap="hideImageModal">
                    关闭
                </button>
            </view>
        </view>
    </view>
</view>
<view class='load-progress {{loadProgress!=0?"show":"hide"}}' style="top:{{CustomBar}}px;">
    <view class='load-progress-bar bg-green' style="transform: translate3d(-{{100-loadProgress}}%, 0px, 0px);"></view>
    <view class='load-progress-spinner text-green'></view>
</view>
<view class='cu-load load-modal' wx:if="{{loadModal}}">
    <view class='gray-text'>处理中...</view>
</view>
<view class="load-curtain" wx:if="{{loadProgress!=0}}"></view>
<view class="cu-modal {{modalName=='ErrModal'?'show':''}}">
    <view class="cu-dialog">
        <view class="cu-bar bg-white justify-end">
            <view class='content'>无法操作</view>
            <view class='action' bindtap='hideModal'>
                <text class='icon-close text-red'></text>
            </view>
        </view>
        <view class='padding-xl'>
            <view class='flex-sub text-center'>
                <view class='solid-bottom text-sl padding'>
                    <text class='icon-warnfill text-red'></text>
                </view>
                <view class='padding'>{{errMsg}}</view>
            </view>
        </view>
    </view>
</view>